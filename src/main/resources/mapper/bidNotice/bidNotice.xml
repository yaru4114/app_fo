<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bid.bo.bid.dao.BidNoticeDao" >

  <!-- 입찰상태코드 목록 조회 -->
  <select id="getBidStatCodeList" resultType="com.bid.common.model.CoCmmnCdVO">
    /* bidNotice.getBidStatCodeList */
    SELECT SUB_CODE
         , CODE_NM
      FROM CO_CMMN_CD
     WHERE MAIN_CODE = 'BID_STAT_001'
     ORDER BY CODE_ORDR
  </select>

  <!-- 입찰 상태별 공고수 조회 -->
  <select id="getBidStatCnt" parameterType="com.bid.bo.bid.vo.BidNoticeVO" resultType="com.bid.bo.bid.vo.BidNoticeVO">
    /* bidNotice.getBidStatCnt */
      SELECT ISNULL(SUM(CASE WHEN BID_STTUS_CODE = '12' THEN 1 ELSE 0 END),0) AS BDNG_SCHDL_CNT
           , ISNULL(SUM(CASE WHEN BID_STTUS_CODE = '13' THEN 1 ELSE 0 END),0) AS BDNG_PRGRS_CNT
           , ISNULL(SUM(CASE WHEN BID_STTUS_CODE = '30' THEN 1 ELSE 0 END),0) AS BDNG_DDLN_CNT
           , ISNULL(SUM(CASE WHEN BID_STTUS_CODE = '32' THEN 1 ELSE 0 END),0) AS BDNG_CLCNT_CNT
           , ISNULL(SUM(CASE WHEN BID_STTUS_CODE = '11' THEN 1 ELSE 0 END),0) AS BDNG_WTNG_CNT
           , ISNULL(COUNT(BID_PBLANC_ID) , 0) AS BDNG_ALL_CNT
       FROM BD_BID_BAS
      WHERE FRST_REGISTER_ID >= CONVERT( DATE , #{startDate})
        AND FRST_REGISTER_ID <![CDATA[ <= ]]> CONVERT(DATE , #{endDate})
  </select>

</mapper>